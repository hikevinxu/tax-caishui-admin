(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6254"],{"+Ejl":function(e,t,i){"use strict";i.r(t);var s=i("gDS+"),a=i.n(s),n=i("YEIV"),o=i.n(n),l=i("DG18"),c=i("Qyje"),r=i.n(c),d=function(e){return Object(l.b)("/fileupload/upload",e)},h=function(e){return Object(l.a)("/service_item/trees",e)},u=function(e){return Object(l.a)("/service_item/service_types",e)},p=function(e){return Object(l.b)("/service_item/add",e)},f=function(e){return Object(l.b)("/service_item/change_shelf",e)},v=function(e){return Object(l.b)("/service_item/delete",e)},g=function(){return Object(l.a)("/serviceType/trees")},m=function(e){return Object(l.b)("/service_item/bulk_add",e)},w=(i("lFhg"),i("Mz3J")),y=(i("33yf"),i("lJCZ"),{name:"mainBusinesss",components:{Pagination:w.a},filters:{typeChange:function(e){return"text"==e?"无":"image"==e?"自定义图片":void 0},statusChange:function(e){return 1==e?"已上架":0==e?"已下架":void 0}},data:function(){var e;return e={noData:!1,id:void 0,listQuery:{pageNum:1,pageSize:20},total:0,fileId:"",fileIdDetail:"",list:[],listData:[],listLoading:!1,dialogPvVisible:!1,dialogUpdate:!1,options1:[],options2:[],options3:[],options4:[],options5:[],options6:[],showOptions3:!1,showOptions4:!1,value:"",value1:"",value2:"",value3:"",value4:"",value5:"",radio:"1",checked:!1,introduceContent:"",hideIntroduceContent:!0,detailTitle:"",createData:{serviceCode:"",introduceContent:"",introduceType:""},introduceImg:"",introduceImgUpload:!1,detailImgUpload:!1,detailImg:""},o()(e,"id",""),o()(e,"disabled",!1),o()(e,"updeteData",{code:"",id:"",introduceContent:{},introduceType:""}),o()(e,"props",{multiple:!0,value:"code",label:"name",children:"childs"}),o()(e,"casList",[]),o()(e,"oneList",[]),o()(e,"codeList",[]),o()(e,"showTwo",!1),o()(e,"showThree",!1),o()(e,"options",[]),e},created:function(){if(this.$route.query.id){this.id=this.$route.query.id;var e={companyId:this.id};this.getList(e),this.getTypes(),this.getTree(e),this.createData.companyId=this.id}},methods:{objectSpanMethod:function(e){var t=e.row,i=(e.column,e.rowIndex,e.columnIndex);return 1===i?t.index%t.count==0?{rowspan:t.count,colspan:1}:{rowspan:0,colspan:0}:2===i?t.childIndex%t.childCount==0?{rowspan:t.childCount,colspan:1}:{rowspan:0,colspan:0}:void 0},goNewService:function(){this.$router.push({path:"/newBusiness"})},upload:function(e){var t=this,i=this.$loading({lock:!0,text:"图片上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=new FormData;s.append("files",e.file),d(s).then(function(s){if(0==s.code){i.close(),console.log(s),t.fileId=s.data[0].fileId;var a=new FileReader,n=e.file;n&&(a.readAsDataURL(n),a.onload=function(e){t.introduceImg=a.result,t.introduceImgUpload=!0})}}).catch(function(e){t.$message.error("上传失败，请重新上传")})},uploadDetail:function(e){var t=this,i=this.$loading({lock:!0,text:"图片上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=new FormData;s.append("files",e.file),d(s).then(function(s){if(i.close(),0==s.code){console.log(s),t.fileIdDetail=s.data[0].fileId;var a=new FileReader,n=e.file;n&&(a.readAsDataURL(n),a.onload=function(e){t.detailImg=a.result,t.detailImgUpload=!0})}}).catch(function(e){t.$message.error("上传失败，请重新上传")})},getList:function(e){var t=this;this.listData=[],h(e).then(function(e){if(console.log(e),0==e.code){t.list=e.data,e.data&&0!=e.data.length?t.noData=!1:t.noData=!0;for(var i=0;i<t.list.length;i++){for(var s=0,a=-1,n=0;n<t.list[i].childs.length;n++)t.list[i].childs[n].childs&&t.list[i].childs[n].childs.length>0?s+=t.list[i].childs[n].childs.length:s+=1;console.log(s);for(var o=0;o<t.list[i].childs.length;o++){t.list[i].childs[o].childs&&0!=t.list[i].childs[o].childs.length||(t.list[i].childs[o].childs=[{name:"无",id:t.list[i].childs[o].id,shelf:t.list[i].childs[o].shelf}]);for(var l=0;l<t.list[i].childs[o].childs.length;l++)a+=1,t.listData.push({id:t.list[i].childs[o].childs[l].id,shelf:t.list[i].childs[o].childs[l].shelf,firstName:t.list[i].name,index:a,count:s,childIndex:l,childCount:t.list[i].childs[o].childs.length,secondName:t.list[i].childs[o].name,thirdName:t.list[i].childs[o].childs[l].name})}}console.log(t.listData)}})},getTree:function(){var e=this;g().then(function(t){0==t.code&&(e.options=t.data)})},getTypes:function(){var e=this;u().then(function(t){0==t.code&&(e.options1=t.data)})},getType1:function(){var e=this;this.value1="",this.value2="",this.options3=[],this.showOptions3=!1;var t={parentCode:this.value};u(t).then(function(t){0==t.code&&(e.options2=t.data)})},getType2:function(){var e=this,t={parentCode:this.value1};u(t).then(function(t){0==t.code&&(t.data.length>0?(e.options3=t.data,e.showOptions3=!0):(e.options3=[],e.showOptions3=!1))})},getType3:function(){var e=this,t={parentCode:this.value3};u(t).then(function(t){0==t.code&&(e.options5=t.data)})},getType4:function(){var e=this,t={parentCode:this.value4};u(t).then(function(t){0==t.code&&(t.data.length>0?(e.options6=t.data,e.showOptions4=!0):(e.options6=[],e.showOptions4=!1))})},create:function(){if("1"==this.radio)this.createData.introduceType="text",""!=this.value&&""!=this.value1?1==this.showOptions3?""!=this.value2?(this.createData.serviceCode=this.value2,this.createData.introduceContent="",this.submit(this.createData)):(this.createData.serviceCode=this.value1,this.createData.introduceContent="",this.submit(this.createData)):(this.createData.serviceCode=this.value1,this.submit(this.createData)):this.$message({message:"请填写数据后保存",type:"warning",showClose:!0,duration:1e3});else if("2"==this.radio)if(this.createData.introduceType="image",0==this.checked)if(""!=this.value&&""!=this.fileId&&""!=this.value1)if(1==this.showOptions3)if(""!=this.value2){this.createData.serviceCode=this.value2;var e={introduceImg:this.fileId,detailJump:!1};this.createData.introduceContent=a()(e),this.submit(this.createData)}else this.$message({message:"请填写数据后保存",type:"warning",showClose:!0,duration:1e3});else{this.createData.serviceCode=this.value1;var t={introduceImg:this.fileId,detailJump:!1};this.createData.introduceContent=a()(t),this.submit(this.createData)}else this.$message({message:"请填写数据后保存",type:"warning",showClose:!0,duration:1e3});else if(""!=this.value&&""!=this.fileId&&""!=this.value1&&""!=this.fileIdDetail)if(1==this.showOptions3)if(""!=this.value2){this.createData.serviceCode=this.value2;var i={introduceImg:this.fileId,detailJump:!0,detailTitle:this.detailTitle,detailImg:this.fileIdDetail};this.createData.introduceContent=a()(i),this.submit(this.createData)}else this.$message({message:"请填写数据后保存",type:"warning",showClose:!0,duration:1e3});else{this.createData.serviceCode=this.value1;var s={introduceImg:this.fileId,detailJump:!0,detailTitle:this.detailTitle,detailImg:this.fileIdDetail};this.createData.introduceContent=a()(s),this.submit(this.createData)}else this.$message({message:"请填写数据后保存",type:"warning",showClose:!0,duration:1e3})},submit:function(e){var t=this;p(e).then(function(e){if(console.log(e),0==e.code){t.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3});var i={companyId:t.id};t.getList(i),t.dialogPvVisible=!1}else{t.$message({message:"保存失败",type:"error",showClose:!0,duration:1e3});var s={companyId:t.id};t.getList(s),t.dialogPvVisible=!1}})},handleFetchPv:function(){this.dialogPvVisible=!0,this.resetForm()},resetForm:function(){this.value="",this.value1="",this.value3="",this.showOptions3=!1,this.options3=[],this.options5=[],this.value4="",this.options6=[],this.showOptions4=!1,this.value5="",this.radio="1",this.checked=!1,this.introduceContent="",this.introduceImg="",this.introduceImgUpload=!1,this.detailTitle="",this.detailImg="",this.fileId="",this.fileIdDetail="",this.detailImgUpload=!1,this.introduceContent=""},handleUpdate:function(e){var t=this;this.resetForm(),this.dialogUpdate=!0,this.id=e.id,this.disabled=!0,console.log(e),this.value3=e.parentCodes[0];var i={parentCode:this.value3};if(u(i).then(function(e){0==e.code&&(t.options5=e.data)}),e.parentCodes.length>1){this.value4=e.parentCodes[1],this.value5=e.code,this.showOptions4=!0;var s={parentCode:this.value4};u(s).then(function(e){0==e.code&&(t.options6=e.data)})}else this.value4=e.code;"text"==e.introduceType?(this.radio="1",this.introduceContent=e.introduceContent,this.checked=!1):(this.radio="2",this.introduceContent=JSON.parse(e.introduceContent),this.introduceImg=this.introduceContent.introduceImg,this.introduceImgUpload=!0,1==this.introduceContent.detailJump?(this.checked=!0,this.detailTitle=this.introduceContent.detailTitle,this.detailImg=this.introduceContent.detailImg,this.detailImgUpload=!0):(this.detailTitle="",this.detailImg="",this.detailImgUpload=!1,this.checked=!1))},changeShelfUp:function(e){var t=this;console.log(e);var i={id:e.id,shelf:!0,companyId:this.id};i=r.a.stringify(i),console.log(i),f(i).then(function(e){if(console.log(e),0==e.code){t.$message({message:"上架成功",type:"success",showClose:!0,duration:1e3});var i={companyId:t.id};t.getList(i)}else{t.$message({message:"上架失败",type:"success",showClose:!0,duration:1e3});var s={companyId:t.id};t.getList(s)}})},changeShelfDown:function(e){var t=this;console.log(e),this.$confirm("业务下架后，关联服务将同时被下架，确认下架？","提示",{}).then(function(){var i={id:e.id,shelf:!1,companyId:t.id};i=r.a.stringify(i),console.log(i),f(i).then(function(e){if(console.log(e),0==e.code){t.$message({message:"下架成功",type:"success",showClose:!0,duration:1e3});var i={companyId:t.id};t.getList(i)}else{t.$message({message:"下架失败",type:"success",showClose:!0,duration:1e3});var s={companyId:t.id};t.getList(s)}})})},serviceDelete:function(e){var t=this,i={id:e.id,companyId:this.id};i=r.a.stringify(i),this.$confirm("确认删除该业务?","提示",{}).then(function(){v(i).then(function(e){if(0==e.code){t.$message({message:"删除成功",type:"success",showClose:!0,duration:1e3});var i={companyId:t.id};t.getList(i)}else{t.$message({message:"删除失败",type:"error",showClose:!0,duration:1e3});var s={companyId:t.id};t.getList(s)}})})},casa:function(e){console.log(e);for(var t=[],i=[],s=0;s<this.casList.length;s++)i.push(this.casList[s][this.casList[s].length-1]),-1==t.indexOf(this.casList[s][0])&&(t.push(this.casList[s][0]),this.oneList=t);this.codeList=i,this.oneList.length>3&&this.$message({message:"一级业务最多添加三个",type:"error",showClose:!0,duration:1e3})},chose:function(e){1==e.length?(this.showTwo=!0,this.showThree=!1):2==e.length&&(this.showThree=!0)},refuse:function(){var e=this;if(this.oneList.length>3)this.$message({message:"一级业务最多添加三个",type:"error",showClose:!0,duration:1e3});else{var t={codes:this.codeList,companyId:this.id};console.log(t),m(t).then(function(t){if(console.log(t),0==t.code){e.$message({message:"添加成功",type:"success",showClose:!0,duration:1e3});var i={companyId:e.id};e.getList(i),e.casList=[]}})}}}}),b=(i("qQbd"),i("KHd+")),C=Object(b.a)(y,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainBusinesss"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.noData,expression:"!noData"}],staticClass:"business"},[i("div",{staticClass:"business_title"},[i("h4",[e._v("主营业务管理")]),e._v(" "),i("span",{staticClass:"addBusiness",on:{click:e.handleFetchPv}},[e._v("+添加新业务")])]),e._v(" "),i("div",{staticClass:"business_content"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.listData,"span-method":e.objectSpanMethod,border:"",fit:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",prop:"id",align:"center",width:"80PX"}}),e._v(" "),i("el-table-column",{attrs:{label:"主业务",width:"250PX",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.firstName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"子业务",width:"250PX",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.secondName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"状态",width:"120PX",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.shelf?i("el-tag",{attrs:{type:"success"}},[e._v(e._s(e._f("statusChange")(t.row.shelf)))]):e._e(),e._v(" "),0==t.row.shelf?i("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e._f("statusChange")(t.row.shelf)))]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"200PX","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.row.shelf,expression:"scope.row.shelf == false"}],staticStyle:{"margin-left":"12PX",color:"#f56c6c"},attrs:{type:"text",size:"small"},on:{click:function(i){e.changeShelfUp(t.row)}}},[e._v("上架")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.shelf,expression:"scope.row.shelf == true"}],staticStyle:{"margin-left":"12PX",color:"#5AB3A4"},attrs:{type:"text",size:"small"},on:{click:function(i){e.changeShelfDown(t.row)}}},[e._v("下架")])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogPvVisible,title:"添加业务"},on:{"update:visible":function(t){e.dialogPvVisible=t}}},[i("div",{staticClass:"choseBusiness"},[i("div",{staticClass:"title",staticStyle:{"font-size":"14PX",color:"rgba(0,0,0,0.60)"}},[e._v("选择业务")]),e._v(" "),i("div",{staticClass:"selectLine"},[i("el-select",{staticStyle:{width:"33%"},attrs:{placeholder:"请选择"},on:{change:e.getType1},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options1,function(e){return i("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),e._v(" "),i("el-select",{staticStyle:{width:"33%"},attrs:{placeholder:"请选择"},on:{change:e.getType2},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options2,function(e){return i("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}))],1)]),e._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"newBtn"},[i("span",[e._v("没有找到相关业务？")])]),e._v(" "),i("div",[i("el-button",{on:{click:function(t){e.dialogPvVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"success"},on:{click:function(t){e.create()}}},[e._v("保存")])],1)])])],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.noData,expression:"noData"}],staticClass:"business"},[e._m(0),e._v(" "),e._m(1),e._v(" "),i("div",{staticClass:"business_content_noData"},[i("div",{staticClass:"case"},[i("div",{staticClass:"title"},[i("span",[e._v("主业务")]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.showTwo,expression:"showTwo"}]},[e._v("子业务")]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.showThree,expression:"showThree"}]},[e._v("子子业务")])]),e._v(" "),i("el-cascader-panel",{attrs:{props:e.props,options:e.options},on:{change:e.casa,"expand-change":e.chose},model:{value:e.casList,callback:function(t){e.casList=t},expression:"casList"}})],1),e._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"flex-start",width:"100%","margin-top":"16PX"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{width:"120PX"},attrs:{type:"primary"},on:{click:e.refuse}},[e._v("添加")])],1)])])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"business_title"},[t("h4",[this._v("业务管理")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"business_title",staticStyle:{"justify-content":"flex-start","margin-top":"16PX"}},[t("h4",{staticStyle:{"font-size":"14PX"}},[this._v("新增业务")]),this._v(" "),t("span",{staticStyle:{"font-size":"12PX",color:"rgba(0,0,0,0.38)","margin-left":"16PX"}},[this._v("(最多添加3个主营业务)")])])}],!1,null,null,null);C.options.__file="mainBusiness.vue";t.default=C.exports},46:function(e,t){},47:function(e,t){},"BCG+":function(e,t,i){},Mz3J:function(e,t,i){"use strict";Math.easeInOutQuad=function(e,t,i,s){return(e/=s/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t};var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function a(e,t,i){var a=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,n=e-a,o=0;t=void 0===t?500:t;!function e(){o+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(o,a,n,t)),o<t?s(e):i&&"function"==typeof i&&i()}()}var n={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&a(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&a(0,800)}}},o=(i("PelQ"),i("KHd+")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},[],!1,null,"7d9f0a7c",null);l.options.__file="index.vue";t.a=l.exports},PelQ:function(e,t,i){"use strict";var s=i("X9ZH");i.n(s).a},X9ZH:function(e,t,i){},lFhg:function(e,t,i){"use strict";var s=i("DG18"),a=i("Qyje"),n=i.n(a);t.a={serviceList:function(e){var t=n.a.stringify(e);return Object(s.b)("/merchant/service/list",t)},serviceAdd:function(e){return Object(s.b)("/merchant/service/add",e)},serviceUpdate:function(e){return Object(s.b)("/merchant/service/update",e)},serviceShelfDown:function(e){var t=n.a.stringify(e);return Object(s.b)("/merchant/service/shelf/down",t)},serviceShelfUp:function(e){var t=n.a.stringify(e);return Object(s.b)("/merchant/service/shelf/up",t)},serviceItemTrees:function(e){return Object(s.a)("/merchant/service/service_items",e)},serviceEdit:function(e){return Object(s.a)("/merchant/service/edit",e)},serviceTemplate:function(e){return Object(s.a)("/merchant/service/template",e)}}},qQbd:function(e,t,i){"use strict";var s=i("BCG+");i.n(s).a}}]);